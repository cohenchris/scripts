#!/bin/sh

# This is a wrapper script for lf which handles the following:
# - Run directly or via SSH in any manner   --> Execute vanilla lf
# - Sourced current terminal                --> On exit, cd to the last active directory

set -e

# lfcd()
#
# Wrapper to update the working directory after exiting lf
lfcd () {
    # `command` is needed in case `lf` is aliased
    cd "$(command lf -print-last-dir "$@")"
}


if [ -n "$SSH_CLIENT" ] || [ -n "$SSH_TTY" ]; then
  # Running inside SSH, just execute normal lf
	command lf "$@"
else
  [ ! -d "${XDG_CACHE_HOME}/lf" ] && mkdir -p "${XDG_CACHE_HOME}/lf"
	lfcd "$@" 3>&-
fi
